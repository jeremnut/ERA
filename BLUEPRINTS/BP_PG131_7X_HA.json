{"status":{},"contains_secrets":true,"product_version":"3.3.1","spec":{"description":"Prepare and customized OS and PGSQL 13 pre-deployment operations to have a successfull master for ERA.\nPrerequisite : \nDisk image of Centos 7.9 with minimal install\nDhcp Network with Internet Access","resources":{"client_attrs":{"None":{"y":-1139.2082320526,"x":-1887.4435769564},"943b25b7_deployment":{"y":-1149.2082320526,"x":-1897.4435769564}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a0a21fa6_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7c38ee45_runbook","main_task_local_reference":{"kind":"app_task","name":"a0a21fa6_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b8bd6f25_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"30639720_runbook","main_task_local_reference":{"kind":"app_task","name":"b8bd6f25_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c76a4c77_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"f16764b5_runbook","main_task_local_reference":{"kind":"app_task","name":"c76a4c77_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"48f17257_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6d6010ef_runbook","main_task_local_reference":{"kind":"app_task","name":"48f17257_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3b9e9095_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"87a6cdee_runbook","main_task_local_reference":{"kind":"app_task","name":"3b9e9095_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"Postgresql 13_1 HA","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[{"description":"Set - PGSQL 12  varialbes","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"AHV_MyPgsql13_1_HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"872ac1d5_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"cdcc60b3_runbook","main_task_local_reference":{"kind":"app_task","name":"872ac1d5_dag"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MyPgsql12Version","value":"Postgresql-12","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"AHV_MyPgsql13_1_HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"094a4d34_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"f57eafe6_runbook","main_task_local_reference":{"kind":"app_task","name":"094a4d34_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"AHV_MyPgsql13_1_HA","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"cred_root"}},"os_type":"Linux","create_spec":{"name":"m-pgsql131-ha","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"f3e721ce-79f3-4af8-a6ad-76fda471dd39"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":8192,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":null,"power_state":"ON","type":"","account_uuid":"6639980a-52b3-4eb5-b127-5272c9ede582","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"LEGACY","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"m-centos79-std","uuid":"e199f49b-d262-4158-991b-b7eec2c43be0"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"root","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"b\/bfhIS8+yxPsZxK2ByemAGSV9yAxtdx8pXt9bbbqPKZdfUc52ZfeHj3:utf-8"},"name":"cred_root","cred_class":"static"},{"username":"postgres","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"FcvDvAdPwuPlKwRwo6jBpEDW7AwTljAjQn\/j07z95hNqI7WOpoOmMj09:utf-8"},"name":"cred_postgres","cred_class":"static"},{"username":"era","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"fhHISukT8N9akMNomF+9rzNKvXvQkMjIR3QLYHdc9MqHEVYm2Ta\/H4WBSTiL\/D0XFCfp7IHdMQrLuSQJ4bSxRtF9GHR\/b3TuRK0XnHQ7r1dxGxbclyPikeOLMRwjxxOYR45QftpxE\/T1SGPhuOIUTKzWa6y7K8E6WWU4AHYnxqR3JuzSsC226mRjHKqLYfulY0H5vAWtzqgadUtLIEmQHt1tK\/BxhQFkEh4\/EqYhabSskJVK8cdlvsnDhDntaeursJoek7vBJAJz1f7S+XhbzrtM86tcShxvi8QJWAaL3IJVEiR+s46+eYLnL8fqCb6cyOnOFdGlE67hNLcAn8iv\/04xFJ3eyDwDLQPTCnPFI9m9bY3H4564aAMnnky7vCGc747UoExWU4nnc3newIFtp0vCthnaIIrmS3WdSykdrIJbzb85jrZ1bGriACmkXnnBZpaDynayYBeMNrlYCr2\/iHPfbhMdi+fE5cj1t9VWzQFNPMWiRDUhfS9lpyjvPnwVE4nTjkEs2U0nZSUu5sgDsD8Oz\/YesvCdxJ6fFfKF3ORY+8QKIOFzK12Z6m8krdhe5xdYC7kUm51+XA4GgunIzeHER3KwrKzZv86flXvq35Wx6r3tRWrkNOmKz1SwKCeMxSec13EQXFkwEO0tO7QozL+YW9Ko8L+jmRR66mWCv33ihoUuUN3C6aLX0F7OmohfEGkYaGRdu6swAOqY+ig0qXjwiHg\/JZbo5ouic842vt9e1EVWPJ2zjwpuCBnrzh67Iztq4ZBxxH2bpEFq3WobmsPxiXQpoJOx5CFGJukyli6wI7Ls9GPdV9kr3+sAz1T26TCSLEfsK42p6c83Lai\/MKOp\/FS28KPF5R+R0Pib8ez0c9FeXdc1cw5JNQQVnoPQse2JvmGBZwKsglVnGODad4I6T46416ZOUCbSRotLsz2UnqjKuxsnU85EkvRylUTph4yuWU8vRqAYUgLAQ\/wOguwDeKlX74Lx4uyE7v3fFDIk0Z9rQmo6IURQbZNuepTYMw16ek+\/\/z9bJGj5K6e3qQ9eKbaeUkfyA72gdprapHT5dVTIlDaHPnYgYBAOFInPrC45u5yTLQHvQqS7yAOUH3CqjGG2gZOU+I5Pnk4booWhEr4PPl7y7xmwOD8k57L9OxvAkOc8e5mCU9P7r0Sp3OzI40vTyXYQ\/LNW0HCcfoz6USamJHL\/n2X5tXXWX9CN31jEC8qqTn+44IrQfeDR7U\/I9cNlBgW7zJc1hC9kVmsrVZ90Vp94RvYiseJ3wHLOQZQWQ2bhsnxWM9DoD6NHsZTY3RiJT9fvrNVgcWxF8PlPTQYj0X3Xx8Mq+xBJLbvMzVRlR\/JysBEeV2bW8\/cQZ3ij3KrRl9nzR9DH5GKPYh385ELznF0Sw6AzMmA1PYkgLoSvaKNgb0djaFBar1Rz9rMf66b7GbRVs0NChI\/Y9HKYlpzIgBpUqvDpl+nhcKNyXuoYVZwGWmZClzqjn6\/hN+oL8NTnS4yAaxO0xEpcx5OjHq4ioMu8Ycy059k0dJJvbgH\/RHzC8O7d5nwwiF2aBREIeiTK27YuN65Gto1jbDxiMHptWM0pv9uHGGLdGCTl68saqMuBpe6GE4MA7PjtU2\/VK1yq9LFcVH9UCJ2dfllrWahh0EGq+WqDaAFryeTUUGFc7sN0Aic4FvHPUsZ9Jf9UnkUhk\/vqOr25I+k9Yhqqz67ooddUwjaunvlIuDi63K4lO3pwArdYHlzk+ckZ4GenHcRxQwfBMNbmVXryOnPUh7aPeqBsmnaVw23J4r2fz3JqIR3LaAW48AcxjWm8PyTvzXeh1yYD\/EUDKdJ\/zMG\/FzwyI+Tuhvi++o+QiV43uyUbSh\/ojSRohgotNN1HNQBvBdfmL0kK\/xg+IEx2MkGaHpucvnUUJzP6icmCIVd3GvQeiP+5\/N8vQrk3bh2CXMaLFtedO\/BcPR8OXCqoaNpN1AVL8Fpj4L8umlJbc\/AfB3zCggeOJDFy+xVUSaA+G+78IQSs0A2Wl402E5k1\/q+h+GCMiSIa5TM1UE6UOhEEKWZ34AKZiRliqvXJU+7Cn9nvyk6T47RvhVztoycMtFg5YgBTMz\/moPPSWB1JktGW+ZVXymR1vV1OdoYGacB8q21GoW1N1ANum4LaVd0VdjFQkhbDitkiLPWlT6U8TAaJQ4o3SbolP2vFgKxRiDley3tU6iVaavY28Kk6wtP+HOBwtcxHSDcaGPXC00tGsQ9UgfdfwvkYdBr2RMZmO7CsBmCUmEuZV1az1Ak=:utf-8"},"name":"cred_era_admin","cred_class":"static"},{"username":"pgwatch","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"f2qqNH\/K89rVJNngHmDB0Guygc+NrfYS0Rcr4LMk\/fVXNhgueCF1gE8w:utf-8"},"name":"cred_pgwatch","cred_class":"static"},{"username":"node_exporter","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"RGr0mOTuhaDuA45iQP5tSx9TF+xTBH51NaAZTPu32mwRuK7\/NHmb+oEL:utf-8"},"name":"cred_node_exporter","cred_class":"static"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Postgresql 13_1 HA"}],"name":"PkgPgsql 13_1 HA","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PkgPgsql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"OsConfiguration"},{"kind":"app_task","name":"OsPostGresPreReqs"},{"kind":"app_task","name":"PgsqlEraSpecificRpms"},{"kind":"app_task","name":"OsPostgresGroupsAndUsers"},{"kind":"app_task","name":"PgsqlDeployment"},{"kind":"app_task","name":"InitPgsqlParams"},{"kind":"app_task","name":"PgsqlInitDbAndAutoStart"},{"kind":"app_task","name":"PatroniHaAppDeployment"},{"kind":"app_task","name":"Restart"}],"name":"5fd9359c_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"OsConfiguration"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"OsPostGresPreReqs"}},{"from_task_reference":{"kind":"app_task","name":"OsPostGresPreReqs"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"PgsqlEraSpecificRpms"}},{"from_task_reference":{"kind":"app_task","name":"PgsqlEraSpecificRpms"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"OsPostgresGroupsAndUsers"}},{"from_task_reference":{"kind":"app_task","name":"OsPostgresGroupsAndUsers"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"PgsqlDeployment"}},{"from_task_reference":{"kind":"app_task","name":"PgsqlDeployment"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"InitPgsqlParams"}},{"from_task_reference":{"kind":"app_task","name":"InitPgsqlParams"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"PgsqlInitDbAndAutoStart"}},{"from_task_reference":{"kind":"app_task","name":"PgsqlInitDbAndAutoStart"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"PatroniHaAppDeployment"}},{"from_task_reference":{"kind":"app_task","name":"PatroniHaAppDeployment"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"OsConfiguration","attrs":{"exit_status":[],"script":"# 1 - OsConfiguration\n#Disabled firewall Linux\n\n#! \/bin\/bash -x\n\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : CONFIGURE SYSTEM\"\necho \"\"\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : STOP FIREWALLD\"\necho \"\"\nsystemctl stop firewalld\nsystemctl status firewalld\n\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : DISABLED SE LINUX\"\necho \"\"\nsudo sed -i 's\/SELINUX=enforcing\/SELINUX=permissive\/g' \/etc\/selinux\/config\nsetenforce 0\ncat \/etc\/selinux\/config\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : DISABLE SSH ACCESS ROOT\"\necho \"\"\nsudo sed -i 's\/PermitRootLogin yes\/PermitRootLogin no\/g' \/etc\/ssh\/sshd_config\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : CONFIGURED PAM.D\"\necho \"\"\necho 'session    required   \/lib64\/security\/pam_limits.so' >> \/etc\/pam.d\/login\n\n\n\necho \"Postgres @@{MyPgsqlVersion}@@ : CONFIGURE HOSTNAME\"\nhostnamectl set-hostname '@@{name}@@'\nrm -rf \/etc\/hosts\necho -e '127.0.0.1       localhost localhost.localdomain localhost4 localhost4.localdomain4\\n@@{address}@@  @@{name}@@  @@{name}@@.@@{MyDnsDomain}@@' >> \/etc\/hosts\n\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"OsPostGresPreReqs","attrs":{"exit_status":[],"script":"#Script 2 - OsPostGres Prereqs\n#! \/bin\/bash -x\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : CONFIGURE SYSCTL RULE\"\necho \"recommanded nutanix value\"\necho \"\"\necho 'vm.swappiness=0\nvm.overcommit_memory = 1\nvm.nr_hugepages=0\nvm.dirty_background_ratio = 5\nvm.dirty_ratio = 15\nvm.dirty_expire_centisecs = 500\nvm.dirty_writeback_centisecs=100' | sudo tee \/etc\/sysctl.d\/97-pgsql-database-sysctl.conf\nsudo sysctl -p \/etc\/sysctl.d\/97-pgsql-database-sysctl.conf\n\necho 'net.ipv4.conf.all.accept_redirects=0\nnet.ipv4.conf.eth0.accept_redirects=0' | sudo tee \/etc\/sysctl.d\/96-disable-icmpv4.conf\nsudo sysctl -p \/etc\/sysctl.d\/96-disable-icmpv4.conf\n\necho 'net.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1' | sudo tee \/etc\/sysctl.d\/95-disable-ipv6.conf\nsudo sysctl -p \/etc\/sysctl.d\/95-disable-ipv6.conf\n\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : CONFIGURE SYSCTL RULE\"\necho \"recommanded value disk sector configuration\"\necho \"\"\necho '\nACTION==\"add|change\", SUBSYSTEM==\"block\", RUN+=\"\/bin\/sh -c '\/bin\/echo 1024 > \/sys%p\/queue\/max_sectors_kb'\"'| sudo tee \/etc\/udev\/rules.d\/71-block-max-sectors.rules\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"PgsqlEraSpecificRpms","attrs":{"exit_status":[],"script":"#Script 3 - PgsqlEraSpecificRpms\n#! \/bin\/bash -x\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : INSTALL OS RPM\"\necho \"\"\n\nyum install net-tools -y\nyum install epel-release -y\nyum install centos-release-scl-rh -y\nyum install iptables-services -y\nyum install gcc -y\nyum install zlib-devel -y\nyum install readline-devel -y\nyum install sshpass -y\nyum install unzip -y\nyum install rsync -y\nyum install zip -y\nyum install wget -y\nyum install python3 -y\nyum install python3-pip -y\nyum install nfs-utils -y\nyum install lsof -y\nyum install git -y\nyum install make -y\nyum install ncurses-devel -y\n\n # for CentOS 7\n \necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : INSTALL CUSTOMER RPM\"\necho \"\"\n\n#rsyslog\ncd \/etc\/yum.repos.d\/\nwget http:\/\/rpms.adiscon.com\/v8-stable\/rsyslog.repo\nyum install rsyslog -y\n\n#I3T\nyum install nc -y\nyum install mlocate -y\n\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"OsPostgresGroupsAndUsers","attrs":{"exit_status":[],"script":"#Script 5 - OsOracleGroupsAndUsers\n\n#! \/bin\/bash -x\n\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : GROUP CONFIGURATION\"\necho \"\"\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : POSTGRES_USER_CONFIGURATION\"\necho \"\"\nuseradd -u 1002 -d \/home\/'@@{cred_postgres.username}@@' -s \/bin\/bash '@@{cred_postgres.username}@@'\n\necho \"@@{cred_postgres.username}@@:@@{cred_postgres.secret}@@\" | chpasswd\necho \"#POSTGRES CONFIG SUDOERS\" >> \/etc\/sudoers\necho \"@@{cred_postgres.username}@@   ALL=(ALL) NOPASSWD:ALL\" >> \/etc\/sudoers\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : GROUP CONFIGURATION\"\necho \"\"\n\necho '# .bashrc\n# User specific aliases and functions\nLC_ALL=\"en_US.UTF-8\"\nLC_CTYPE=\"en_US.UTF-8\"\nexport LC_ALL\nexport LC_CTYPE\nexport PGHOST=localhost' | sudo tee \/home\/'@@{cred_postgres.username}@@'\/.bashrc\n\n\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : ERA_USER_CONFIGURATION\"\necho \"\"\nuseradd -u 1003 -d \/home\/'@@{cred_era_admin.username}@@' -s \/bin\/bash '@@{cred_era_admin.username}@@'\necho \"@@{cred_era_admin.username}@@\":\"Nutanix.1\" | chpasswd\necho \"#ERA CONFIG SUDOERS\" >> \/etc\/sudoers\necho \"@@{cred_era_admin.username}@@  ALL=(ALL) NOPASSWD:ALL\" >> \/etc\/sudoers\n\nmkdir \/home\/'@@{cred_era_admin.username}@@'\/.ssh\/\necho '@@{era_PublicKey}@@' >> \/home\/'@@{cred_era_admin.username}@@'\/.ssh\/authorized_keys\n\nchmod 700  \/home\/'@@{cred_era_admin.username}@@'\/.ssh\nchmod 600 \/home\/'@@{cred_era_admin.username}@@'\/.ssh\/authorized_keys\nchown -R '@@{cred_era_admin.username}@@':'@@{cred_era_admin.username}@@' \/home\/'@@{cred_era_admin.username}@@'\/.ssh\n\necho '# .bashrc\n# User specific aliases and functions\nLC_ALL=\"en_US.UTF-8\"\nLC_CTYPE=\"en_US.UTF-8\"\nexport LC_ALL\nexport LC_CTYPE\nexport PGHOST=localhost' | sudo tee \/home\/'@@{cred_era_admin.username}@@'\/.bashrc\n\n\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"PgsqlDeployment","attrs":{"exit_status":[],"script":"#Script 5 - OsOracleGroupsAndUsers\n\n#! \/bin\/bash -x\n\nsudo yum install -y https:\/\/download.postgresql.org\/pub\/repos\/yum\/reporpms\/EL-7-x86_64\/pgdg-redhat-repo-latest.noarch.rpm\nsudo yum install -y postgresql13-server*13.1*\nsudo yum install -y postgresql13-contrib*13.1*\nsudo yum install -y postgresql13-libs*13.1*\nsudo yum install -y postgresql13-devel*13.1*\nsudo yum install -y postgresql13-llvmjit*13.1*\n\n\n#pgwatch requirements postgres\nsudo yum install -y  postgresql13-plpython3*13.1*\n\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_postgres"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"InitPgsqlParams","attrs":{"exit_status":[],"script":"#! \/bin\/bash -x\n\nmkdir \/usr\/local\/pgsql\nchown postgres \/usr\/local\/pgsql\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"PgsqlInitDbAndAutoStart","attrs":{"exit_status":[],"script":"#! \/bin\/bash -x\n\n#sudo \/usr\/pgsql-12\/bin\/postgresql-12-setup initdb\n\nsudo systemctl disable postgresql-13\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_postgres"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"PatroniHaAppDeployment","attrs":{"exit_status":[],"script":"#! \/bin\/bash -x\n\n#Configure Pgsql Ha\nsudo yum install python-pip3 -y\nsudo yum install postgresql-devel -y\nsudo yum install python3-devel -y\nsudo yum install etcd-3.3.11 -y\nsudo yum install keepalived -y \nsudo yum install psycopg2 -y\nsudo yum install haproxy -y\n\nsudo pip3 install urllib3==1.24.2\nsudo pip3 install patroni[etcd]==2.0.1\nsudo pip3 install grpcio==1.26.0\nsudo pip3 install etcd3==0.10.0\nsudo pip3 install psycopg2-binary \nsudo ln -s \/usr\/local\/bin\/patroni \/usr\/bin\/patroni\nsudo ln -s \/usr\/local\/bin\/patronictl \/usr\/bin\/patronictl\n\npatroni --version\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_postgres"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"87a6cdee_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"f6662b47_runbook","main_task_local_reference":{"kind":"app_task","name":"5fd9359c_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PkgPgsql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"7cdabcef_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"215048ed_runbook","main_task_local_reference":{"kind":"app_task","name":"7cdabcef_dag"},"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"943b25b7_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"PkgPgsql 13_1 HA"}],"substrate_local_reference":{"kind":"app_substrate","name":"AHV_MyPgsql13_1_HA"},"variable_list":[],"description":""}],"environment_reference_list":[],"patch_list":[],"description":"","action_list":[{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"PrintEraPgHomeDirectoryLatest"}],"name":"ffa63cdf_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"PrintEraPgHomeDirectoryLatest","attrs":{"exit_status":[],"script":"#! \/bin\/bash -x\necho \"POSTGRESQL REPOSITORY\"\necho \"\/usr\/pgsql-13\"\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_era_admin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"54edba71_runbook","main_task_local_reference":{"kind":"app_task","name":"ffa63cdf_dag"},"variable_list":[]},"name":"PrintPghomeEraRegistration"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"DownloadAndInstallPgExporterLatest"}],"name":"dc515448_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"DownloadAndInstallPgExporterLatest","attrs":{"exit_status":[],"script":"#! \/bin\/bash -x\nsudo mkdir \/opt\/postgres_exporter\nsudo cd \/opt\/postgres_exporter \nsudo wget https:\/\/github.com\/wrouesnel\/postgres_exporter\/releases\/download\/v0.8.0\/postgres_exporter_v0.8.0_linux-amd64.tar.gz\nsudo tar -xzvf postgres_exporter_v0.8.0_linux-amd64.tar.gz\ncd postgres_exporter_v0.8.0_linux-amd64\nsudo cp postgres_exporter \/usr\/local\/bin\ncd \/opt\/postgres_exporter\n\n\n\nsudo echo 'DATA_SOURCE_NAME=\"postgresql:\/\/postgres:postgres@localhost:5432\/?sslmode=disable\"' | sudo tee  \/opt\/postgres_exporter\/postgres_exporter.env\n\nsudo echo '[Unit]\nDescription=Prometheus exporter for Postgresql\nWants=network-online.target\nAfter=network-online.target\n[Service]\nUser=postgres\nGroup=postgres\nWorkingDirectory=\/opt\/postgres_exporter\nEnvironmentFile=\/opt\/postgres_exporter\/postgres_exporter.env\nExecStart=\/usr\/local\/bin\/postgres_exporter --web.listen-address=:9187 --web.telemetry-path=\/metrics --extend.query-path=\/opt\/postgres_exporter\/metrics.yaml\nRestart=always \n[Install]\nWantedBy=multi-user.target' | sudo tee  \/etc\/systemd\/system\/postgres_exporter.service\n\nsudo systemctl daemon-reload\nsudo systemctl start postgres_exporter\nsudo systemctl enable postgres_exporter\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_postgres"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"dc0381f2_runbook","main_task_local_reference":{"kind":"app_task","name":"dc515448_dag"},"variable_list":[]},"name":"InstallConfigPostGresExporter"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"CustomerOptionalPackage"}],"name":"79efff4f_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CustomerOptionalPackage","attrs":{"exit_status":[],"script":"#! \/bin\/bash -x\nsudo yum install -y sssd realmd oddjob oddjob-mkhomedir adcli samba-common samba-common-tools krb5-workstation openldap-clients policycoreutils-python\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_postgres"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"296cdf69_runbook","main_task_local_reference":{"kind":"app_task","name":"79efff4f_dag"},"variable_list":[]},"name":"DirectoryConfiguration"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ConfigurePgwatchSystemUser"},{"kind":"app_task","name":"DeployAndConfigInitPgWatch2"},{"kind":"app_task","name":"EnablePgWatch2"}],"name":"53925652_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"ConfigurePgwatchSystemUser"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"DeployAndConfigInitPgWatch2"}},{"from_task_reference":{"kind":"app_task","name":"DeployAndConfigInitPgWatch2"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"EnablePgWatch2"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ConfigurePgwatchSystemUser","attrs":{"exit_status":[],"script":"#! \/bin\/bash\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : PGWATCH_USER_CONFIGURATION\"\necho \"\"\nuseradd -u 1004 -d \/home\/'@@{cred_pgwatch.username}@@' -s \/bin\/bash '@@{cred_pgwatch.username}@@'\necho \"@@{cred_pgwatch.username}@@:@@{cred_pgwatch.secret}@@\" | chpasswd\necho \"#PGWATCH CONFIG SUDOERS\" >> \/etc\/sudoers\necho \"@@{cred_pgwatch.username}@@  ALL=(ALL) NOPASSWD:ALL\" >> \/etc\/sudoers\n\necho '# .bashrc\n# User specific aliases and functions\nLC_ALL=\"en_US.UTF-8\"\nLC_CTYPE=\"en_US.UTF-8\"\nexport LC_ALL\nexport LC_CTYPE\nexport PGHOST=localhost\nexport PATH=$PATH:\/usr\/local\/bin:' | sudo tee \/home\/'@@{cred_pgwatch.username}@@'\/.bashrc\n\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"DeployAndConfigInitPgWatch2","attrs":{"exit_status":[],"script":"#! \/bin\/bash\n\n\nsudo rpm -i https:\/\/github.com\/cybertec-postgresql\/pgwatch2\/releases\/download\/v1.8.5\/pgwatch2_v1.8.5-SNAPSHOT-b39dfdf_linux_64-bit.rpm\ncd \/etc\/pgwatch2\/webpy\/ \npip3 install --user --upgrade pip setuptools\npip3 install --user  -r \/etc\/pgwatch2\/webpy\/requirements_pg_metrics.txt\n\necho '\n[Unit]\nDescription=Pgwatch2 Gathering Daemon\nAfter=network-online.target\n#After=postgresql@12-main.service\n\n[Service]\nUser=pgwatch\nType=notify\nExecStart=\/usr\/bin\/pgwatch2-daemon -c \/etc\/pgwatch2\/config\/instances.yaml -m \/etc\/pgwatch2\/metrics\/ --datastore=prometheus\nRestart=on-failure\nTimeoutStartSec=0\n\n[Install]\nWantedBy=multi-user.target '| sudo tee \/etc\/systemd\/system\/pgwatch2.service\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_pgwatch"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"EnablePgWatch2","attrs":{"exit_status":[],"script":"#! \/bin\/bash\n\nsudo systemctl enable pgwatch2.service\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_pgwatch"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"246c6ba5_runbook","main_task_local_reference":{"kind":"app_task","name":"53925652_dag"},"variable_list":[]},"name":"InstallPgwatch2"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ConfigureNodeExporterSystemUser"},{"kind":"app_task","name":"DeployAndConfigureNodeExporter"},{"kind":"app_task","name":"EnableNodeExporter"}],"name":"acf34272_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"ConfigureNodeExporterSystemUser"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"DeployAndConfigureNodeExporter"}},{"from_task_reference":{"kind":"app_task","name":"DeployAndConfigureNodeExporter"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"EnableNodeExporter"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ConfigureNodeExporterSystemUser","attrs":{"exit_status":[],"script":"#! \/bin\/bash\n\necho \"\"\necho \"Postgres @@{MyPgsqlVersion}@@ : NODE_EXPORTER_USER_CONFIGURATION\"\necho \"\"\nuseradd -u 1005 -d \/home\/'@@{cred_node_exporter.username}@@' -s \/bin\/bash '@@{cred_node_exporter.username}@@'\necho \"@@{cred_node_exporter.username}@@:@@{cred_node_exporter.secret}@@\" | chpasswd\necho \"#NODE_EXPORTER CONFIG SUDOERS\" >> \/etc\/sudoers\necho \"@@{cred_node_exporter.username}@@  ALL=(ALL) NOPASSWD:ALL\" >> \/etc\/sudoers\n\necho '# .bashrc\n# User specific aliases and functions\nLC_ALL=\"en_US.UTF-8\"\nLC_CTYPE=\"en_US.UTF-8\"\nexport LC_ALL\nexport LC_CTYPE\nexport PGHOST=localhost\nexport PATH=$PATH:\/usr\/local\/bin:' | sudo tee \/home\/'@@{cred_node_exporter.username}@@'\/.bashrc\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"DeployAndConfigureNodeExporter","attrs":{"exit_status":[],"script":"#! \/bin\/bash\n\nwget https:\/\/github.com\/prometheus\/node_exporter\/releases\/download\/v1.1.2\/node_exporter-1.1.2.linux-amd64.tar.gz\nsudo tar -xzf node_exporter-1.1.2.linux-amd64.tar.gz\nsudo mv node_exporter-1.1.2.linux-amd64\/node_exporter \/usr\/local\/bin\/\n\necho '\n[Unit]\nDescription=Node Exporter\nAfter=network.target\n \n[Service]\nUser=node_exporter\nGroup=node_exporter\nType=simple\nExecStart=\/usr\/local\/bin\/node_exporter\n \n[Install]\nWantedBy=multi-user.target' | sudo tee \/etc\/systemd\/system\/node_exporter.service\n\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_node_exporter"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"EnableNodeExporter","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nsudo systemctl daemon-reload\nsudo systemctl start node_exporter\nsudo systemctl status node_exporter\nsudo systemctl enable node_exporter\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"cd851d43_runbook","main_task_local_reference":{"kind":"app_task","name":"acf34272_dag"},"variable_list":[]},"name":"InstallAndConfigureNodeExporter"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"CustomerPersonalization"}],"name":"faee1b47_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CustomerPersonalization","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nsudo mkdir -p \/outillage\/add-security\/{bin,etc,log}\nsudo chown -R era:era \/outillage\n\n#Pr\u00e9-requis CACCIA\nsudo yum install -y ksh\nsudo yum install -y sssd\n\necho 'export TMOUT=300' | sudo tee \/etc\/profile.d\/tmout.sh\necho 'setenv TMOUT 300' | sudo tee \/etc\/profile.d\/tmout.csh\n\nexit ","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_era_admin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"a7dc4155_runbook","main_task_local_reference":{"kind":"app_task","name":"faee1b47_dag"},"variable_list":[]},"name":"CustomerPersonalization"},{"description":"Automatic Replacement Based On Customer Requirement","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ScriptPostInfraFilesCustomisation"}],"name":"672ab0f8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScriptPostInfraFilesCustomisation","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nsudo rm \/etc\/chrony.conf\n\necho '\n# Use public servers from the pool.ntp.org project.\n# Please consider joining the pool (http:\/\/www.pool.ntp.org\/join.html).\nserver @@{SrvNtp1}@@ iburst\nserver @@{SrvNtp2}@@ iburst\n\n\n# Record the rate at which the system clock gains\/losses time.\ndriftfile \/var\/lib\/chrony\/drift\n\n# Allow the system clock to be stepped in the first three updates\n# if its offset is larger than 1 second.\nmakestep 1.0 3\n\n# Enable kernel synchronization of the real-time clock (RTC).\nrtcsync\n\n# Increase the minimum number of selectable sources required to adjust\n# the system clock.\nminsources 2\n\n# Specify directory for log files.\nlogdir \/var\/log\/chrony ' | sudo tee \/etc\/chrony.conf\n\nsudo rm \/etc\/resolv.conf\necho '\nsearch @@{DnsSearchList}@@\nnameserver @@{SrvDns1}@@\nnameserver @@{SrvDns2}@@\n' | sudo tee \/etc\/resolv.conf\n\nexit 0","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_era_admin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"a5aa6653_runbook","main_task_local_reference":{"kind":"app_task","name":"672ab0f8_dag"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SrvNtp2","value":"192.168.126.254","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SrvNtp1","value":"192.168.127.254","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SrvDns2","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SrvDns1","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DnsSearchList","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]},"name":"ReplaceNtpDns"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"AddPostgreSqlOptionalPackage"}],"name":"bce13deb_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgresql 13_1 HA"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"AddPostgreSqlOptionalPackage","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n#This is an example\n\nsudo yum install -y pgbackrest\nsudo yum install -y citus_13\nsudo yum install -y postgresql13-plpython3*13.1*\nsudo yum install -y postgresql13-pltcl*13.1*\n\n#https:\/\/github.com\/EnterpriseDB\/sslutils\nsudo yum install -y sslutils_13\n\n\nexit","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"cred_postgres"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"b25cf43d_runbook","main_task_local_reference":{"kind":"app_task","name":"bce13deb_dag"},"variable_list":[]},"name":"PostgresqlOptionalPackage"}],"name":"AppPgsql131EraBased","restore_config_list":[],"snapshot_config_list":[],"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MyPgsqlVersion","value":"VERSION 13.1 HA","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":"^.*$"},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"era_PublicKey","value":"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCJl+oqQYv4lx115BOJZhtfhHJ8laHOcjs40XhUEtO6Kfd6qJifl9lLQglqw7awq9WtxpYUvaspxnw6msrBNpzyI0\/u2T2JY5ZEOQ+IK4ERdz+MMGHxUKnZx\/xfF8Zl2Mn0pVojK+BClOqKErqUep20trXfRUET7OHk4ZF8pveuKkvNsfhe4rL2DXdHpo4113ZXV5sLZKfNya1d1nE0hLVSEBPKawD2I7NOvDjbrumFGfzHyl0AHUG+XhJJaIq3fWxO5BFT8TC3wQFZ3+\/SiiC0pDFGv0FHPxeSpZnFLmM6Iw6a+1wrYKSQUsfK8MBLvZMcpeID8mbkmt1UH7dv6evp","label":"","attrs":{"type":"LOCAL"},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MyDnsDomain","value":"default","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"cred_root"},"type":"USER"},"name":"BP_PG131_7X_HA"},"api_version":"3.0","metadata":{"last_update_time":"1635704050360674","kind":"blueprint","spec_version":0,"creation_time":"1635704050360674","name":"BP_PG131_7X_HA"}}